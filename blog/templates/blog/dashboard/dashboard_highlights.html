{% extends 'blog/templates/template_dashboard.html' %}
{% load staticfiles %}

{% block http_headers %}
<script type="text/javascript">
  // page specific javascript init shit
  (function() {
    // fancy editor window for admins who have javascript
    initialize_tinymce(
      'id_description',
      'textarea.editor',
      'button-clear',
      'button-revert',
      ['{% static "css/common.css" %}', 'http://fonts.googleapis.com/css?family=Sigmar+One|Roboto']);
  })();
</script>
{% endblock %}

{% block content %}
<div class="row">
    <div class="large-12 columns">
        <h2>Link of the Day</h2>
        <hr>

        <h3>New Link of the Day</h3>
        <form id="link_form" action="{% url 'forms-link' %}" method="post"  enctype="multipart/form-data">
            <input type="hidden" name="id" value="{{ highlight_form.id.value|default_if_none:'' }}" />
            <input type="hidden" name="next" value="{% url 'dashboard-highlights' %}" />
            {% csrf_token %}
            <table>
                <tbody>
                <tr>
                    <td class="shrink">{{ highlight_form.title.label_tag }}</td>
                    <td>{{ highlight_form.title }}</td>

                    <td  class="shrink">{{ highlight_form.icon.label_tag }}</td>
                    <td>{{ highlight_form.icon }}</td>
                </tr>
                <tr>
                    <td class="shrink">{{ highlight_form.description.label_tag }}</td>
                    <td colspan="3">{{ highlight_form.description }}</td>
                </tr>
                <tr>
                    <td class="shrink">{{ highlight_form.url.label_tag }}</td>
                    <td colspan="3">{{ highlight_form.url }}</td>
                </tr>
                <tr>
                    <td></td>
                    <td>
                        {% if 'highlight' in request.GET %}
                        <input id="id_submit" type="submit" value="Edit">
                        {% else %}
                        <input id="id_submit" type="submit" value="Create">
                        {% endif %}
                    </td>
                </tr>
                </tbody>
            </table>
        </form>

        <hr>
        <h3>Manage Highlights</h3>
        <table class="editable">
            <tbody>

            <tr>
                <td>Date</td>
                <td>Title</td>
                <td></td>
                <td></td>
            </tr>

            {% for highlight in highlights %}
            <tr>
                <form action="{% url 'dashboard-backend' %}" method="post">
                    <input type="hidden" name="highlight" value="{{ highlight.id }}" />
                    <input type="hidden" name="next" value="{% url 'dashboard-highlights' %}" />
                    {% csrf_token %}

                    <td class="shrink">{{ highlight.date_published|date:"N j, Y" }}</td>
                    <td class="shrink">
                        <a href="{% url 'dashboard-highlights' %}?highlight={{ highlight.id }}">{{ highlight.title }}</a>
                    </td>
                    <td class="expand">
                        {{ highlight.description }}<br>
                        <a href="{{ highlight.url }}" target="_blank">{{ highlight.url}}</a>
                    </td>
                    <td class="shrink">
                        <input type="submit" name="delete_highlight" value="x">
                    </td>
                </form>
            </tr>
            {% empty %}
            <tr><td>There are no links in the database.</td></tr>
            {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}