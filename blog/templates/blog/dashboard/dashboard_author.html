{% extends 'blog/templates/template_dashboard.html' %}
{% load staticfiles %}

{% block http_headers %}
<script type="text/javascript">
  // page specific javascript init shit
  $(function() {
    // fancy editor window for admins who have javascript
    initialize_tinymce({
      auto_focus: 'id_content',
      content_css: ['{% static "css/mce.css" %}'],
    });
  });
</script>
{% endblock %}

{% block content %}
{% if "thought_slug" in request.GET %}
<h2>Edit Thought</h2>
{% else %}
<h2>Write New Thought</h2>
{% endif %}

<form action="{% url 'forms-thought' %}" method="post" enctype="multipart/form-data">
    {% csrf_token %}
    {% for field in thought_form.hidden_fields %}
    {{ field }}{% endfor %}

    <table class="form-thought">
        <tr>
            <th class="shrink">{{ thought_form.title.label_tag }}</th>
            <td class="expand">{{ thought_form.title }}</td>
        </tr>
        <tr>
            <th>{{ thought_form.slug.label_tag }}</th>
            <td class="shrink">
                {% if thought_form.slug.value %}
                <p id="id_slug">{{ thought_form.slug.value }}</p>
                {% else %}
                {{ thought_form.slug }}
                {% endif %}
            </td>
        </tr>
        <tr>
            <th>{{ thought_form.preview.label_tag }}</th>
            <td class="expand">{{ thought_form.preview }}</td>
        </tr>
        <tr>
            <th>{{ thought_form.idea.label_tag }}</th>
            <td class="shrink">
                {% if not idea %}
                {{ thought_form.idea }}
                {% endif %}
            </td>
        </tr>
        <tr>
            <td colspan="3">{{ thought_form.content }}</td>
        </tr>
        <tr>
            <td colspan="3">
                <input id="button-clear" type="button" value="Clear" />
                <input id="button-revert" type="button" value="Revert" />

                {% if thought_form.is_draft.value == True %}
                <button type="submit" name="is_draft" value="True">Save</button>
                <button type="submit" name="is_draft" value="False" class="publish right">Publish</button>
                {% else %}
                {% if "thought_slug" not in request.GET %}
                <button type="submit" name="is_draft" value="True">Save as Draft</button>
                <button type="submit" name="is_draft" value="False" class="publish right">Publish</button>
                {% else %}
                <button type="submit" name="is_draft" value="False" class="publish right">Edit</button>
                {% endif %}
                {% endif %}
            </td>
        </tr>
    </table>
</form>
{% endblock %}

{% block side %}
<h2>Notes</h2>
<p>Include notes for this idea in this column!</p>

<h2>To Do</h2>
<p>Relevant to do list items.</p>
{% endblock %}

{% block footer %}
<p>
    <a href="{% url 'dashboard' %}">Dashboard</a> //
    {% if "thought_slug" in request.GET %}
    <a href="{% url 'dashboard-ideas' %}">{{ thought_form.idea.value }}</a> //
    <a href="{% url 'dashboard-thoughts' thought_form.idea.value|default_if_none:'' %}">{{ thought_form.title.value }}</a> //
    Edit Thought //
    {% else %}
    <a href="{% url 'dashboard-ideas' %}">Content</a> //
    <a href="{% url 'dashboard-thoughts' %}">Thoughts</a> //
    Post New Thought //
    {% endif %}
    {{ request.user }}
</p>
{% endblock %}